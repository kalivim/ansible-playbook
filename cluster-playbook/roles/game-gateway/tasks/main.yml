---
- name: 部署网关服
  file:
    path: "{{ g_dir }}"
    state: directory

- name: 下载压缩包
  unarchive:
    src: "{{ g_pkg }}"
    dest: "{{ g_dir }}"
    remote_src: True

- name: zk连接配置文件
  template:
    src: appContext.xml.j2
    dest: "{{ g_dir }}/config/appContext.xml"
  tags: 
    - change_config

- name: 数据连接配置文件
  template:
    src: deploy.properties.j2
    dest: "{{ g_dir }}/config/deploy.properties"
  tags: 
    - change_config

- name: 添加定制启动脚本
  template:
    src: srun.sh.j2
    dest: "{{ g_dir }}/srun.sh"
    mode: 0744

- name: 添加管理程序
  copy:
    src: game
    dest: /usr/local/bin/game
    mode: 0744

- name: 添加快捷路径
  shell: "echo 'cd {{ g_dir }}' >> /etc/profile"
  tags:
    - link_path
